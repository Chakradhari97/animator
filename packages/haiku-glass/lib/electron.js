'use strict';

var qs = require('qs');
var electron = require('electron');
var app = electron.app;
var BrowserWindow = electron.BrowserWindow;
var path = require('path');

var url = 'file://' + path.join(__dirname, '..', 'index.html');

var params = {
  folder: process.env.HAIKU_PROJECT_FOLDER,
  plumbing: process.env.HAIKU_PLUMBING_URL
};

if (process.env.MOCK_ENVOY === '1') {
  params.envoy = { mock: true };
}

console.info('[glass] launching window with params', params);

var query = qs.stringify(params);

url = url + '?' + query;

var mainWindow = void 0;

function createWindow() {
  mainWindow = new BrowserWindow({ width: 1200, height: 800 });
  mainWindow.loadURL(url);

  if (process.env.DEV === '1') {
    mainWindow.webContents.openDevTools();
  }

  mainWindow.on('closed', function () {
    mainWindow = null;
  });
}

app.on('ready', createWindow);

app.on('window-all-closed', function () {
  if (process.platform !== 'darwin') {
    app.quit();
  }
});

app.on('activate', function () {
  if (mainWindow === null) {
    createWindow();
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbGVjdHJvbi5qcyJdLCJuYW1lcyI6WyJxcyIsInJlcXVpcmUiLCJlbGVjdHJvbiIsImFwcCIsIkJyb3dzZXJXaW5kb3ciLCJwYXRoIiwidXJsIiwiam9pbiIsIl9fZGlybmFtZSIsInBhcmFtcyIsImZvbGRlciIsInByb2Nlc3MiLCJlbnYiLCJIQUlLVV9QUk9KRUNUX0ZPTERFUiIsInBsdW1iaW5nIiwiSEFJS1VfUExVTUJJTkdfVVJMIiwiTU9DS19FTlZPWSIsImVudm95IiwibW9jayIsImNvbnNvbGUiLCJpbmZvIiwicXVlcnkiLCJzdHJpbmdpZnkiLCJtYWluV2luZG93IiwiY3JlYXRlV2luZG93Iiwid2lkdGgiLCJoZWlnaHQiLCJsb2FkVVJMIiwiREVWIiwid2ViQ29udGVudHMiLCJvcGVuRGV2VG9vbHMiLCJvbiIsInBsYXRmb3JtIiwicXVpdCJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNQSxLQUFLQyxRQUFRLElBQVIsQ0FBWDtBQUNBLElBQU1DLFdBQVdELFFBQVEsVUFBUixDQUFqQjtBQUNBLElBQU1FLE1BQU1ELFNBQVNDLEdBQXJCO0FBQ0EsSUFBTUMsZ0JBQWdCRixTQUFTRSxhQUEvQjtBQUNBLElBQU1DLE9BQU9KLFFBQVEsTUFBUixDQUFiOztBQUVBLElBQUlLLGtCQUFnQkQsS0FBS0UsSUFBTCxDQUFVQyxTQUFWLEVBQXFCLElBQXJCLEVBQTJCLFlBQTNCLENBQXBCOztBQUVBLElBQU1DLFNBQVM7QUFDYkMsVUFBUUMsUUFBUUMsR0FBUixDQUFZQyxvQkFEUDtBQUViQyxZQUFVSCxRQUFRQyxHQUFSLENBQVlHO0FBRlQsQ0FBZjs7QUFLQSxJQUFJSixRQUFRQyxHQUFSLENBQVlJLFVBQVosS0FBMkIsR0FBL0IsRUFBb0M7QUFDbENQLFNBQU9RLEtBQVAsR0FBZSxFQUFFQyxNQUFNLElBQVIsRUFBZjtBQUNEOztBQUVEQyxRQUFRQyxJQUFSLENBQWEsc0NBQWIsRUFBcURYLE1BQXJEOztBQUVBLElBQU1ZLFFBQVFyQixHQUFHc0IsU0FBSCxDQUFhYixNQUFiLENBQWQ7O0FBRUFILE1BQVNBLEdBQVQsU0FBZ0JlLEtBQWhCOztBQUVBLElBQUlFLG1CQUFKOztBQUVBLFNBQVNDLFlBQVQsR0FBeUI7QUFDdkJELGVBQWEsSUFBSW5CLGFBQUosQ0FBa0IsRUFBRXFCLE9BQU8sSUFBVCxFQUFlQyxRQUFRLEdBQXZCLEVBQWxCLENBQWI7QUFDQUgsYUFBV0ksT0FBWCxDQUFtQnJCLEdBQW5COztBQUVBLE1BQUlLLFFBQVFDLEdBQVIsQ0FBWWdCLEdBQVosS0FBb0IsR0FBeEIsRUFBNkI7QUFDM0JMLGVBQVdNLFdBQVgsQ0FBdUJDLFlBQXZCO0FBQ0Q7O0FBRURQLGFBQVdRLEVBQVgsQ0FBYyxRQUFkLEVBQXdCLFlBQVk7QUFDbENSLGlCQUFhLElBQWI7QUFDRCxHQUZEO0FBR0Q7O0FBRURwQixJQUFJNEIsRUFBSixDQUFPLE9BQVAsRUFBZ0JQLFlBQWhCOztBQUVBckIsSUFBSTRCLEVBQUosQ0FBTyxtQkFBUCxFQUE0QixZQUFZO0FBQ3RDLE1BQUlwQixRQUFRcUIsUUFBUixLQUFxQixRQUF6QixFQUFtQztBQUNqQzdCLFFBQUk4QixJQUFKO0FBQ0Q7QUFDRixDQUpEOztBQU1BOUIsSUFBSTRCLEVBQUosQ0FBTyxVQUFQLEVBQW1CLFlBQVk7QUFDN0IsTUFBSVIsZUFBZSxJQUFuQixFQUF5QjtBQUN2QkM7QUFDRDtBQUNGLENBSkQiLCJmaWxlIjoiZWxlY3Ryb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBxcyA9IHJlcXVpcmUoJ3FzJylcbmNvbnN0IGVsZWN0cm9uID0gcmVxdWlyZSgnZWxlY3Ryb24nKVxuY29uc3QgYXBwID0gZWxlY3Ryb24uYXBwXG5jb25zdCBCcm93c2VyV2luZG93ID0gZWxlY3Ryb24uQnJvd3NlcldpbmRvd1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKVxuXG5sZXQgdXJsID0gYGZpbGU6Ly8ke3BhdGguam9pbihfX2Rpcm5hbWUsICcuLicsICdpbmRleC5odG1sJyl9YFxuXG5jb25zdCBwYXJhbXMgPSB7XG4gIGZvbGRlcjogcHJvY2Vzcy5lbnYuSEFJS1VfUFJPSkVDVF9GT0xERVIsXG4gIHBsdW1iaW5nOiBwcm9jZXNzLmVudi5IQUlLVV9QTFVNQklOR19VUkxcbn1cblxuaWYgKHByb2Nlc3MuZW52Lk1PQ0tfRU5WT1kgPT09ICcxJykge1xuICBwYXJhbXMuZW52b3kgPSB7IG1vY2s6IHRydWUgfVxufVxuXG5jb25zb2xlLmluZm8oJ1tnbGFzc10gbGF1bmNoaW5nIHdpbmRvdyB3aXRoIHBhcmFtcycsIHBhcmFtcylcblxuY29uc3QgcXVlcnkgPSBxcy5zdHJpbmdpZnkocGFyYW1zKVxuXG51cmwgPSBgJHt1cmx9PyR7cXVlcnl9YFxuXG5sZXQgbWFpbldpbmRvd1xuXG5mdW5jdGlvbiBjcmVhdGVXaW5kb3cgKCkge1xuICBtYWluV2luZG93ID0gbmV3IEJyb3dzZXJXaW5kb3coeyB3aWR0aDogMTIwMCwgaGVpZ2h0OiA4MDAgfSlcbiAgbWFpbldpbmRvdy5sb2FkVVJMKHVybClcblxuICBpZiAocHJvY2Vzcy5lbnYuREVWID09PSAnMScpIHtcbiAgICBtYWluV2luZG93LndlYkNvbnRlbnRzLm9wZW5EZXZUb29scygpXG4gIH1cblxuICBtYWluV2luZG93Lm9uKCdjbG9zZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgbWFpbldpbmRvdyA9IG51bGxcbiAgfSlcbn1cblxuYXBwLm9uKCdyZWFkeScsIGNyZWF0ZVdpbmRvdylcblxuYXBwLm9uKCd3aW5kb3ctYWxsLWNsb3NlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKHByb2Nlc3MucGxhdGZvcm0gIT09ICdkYXJ3aW4nKSB7XG4gICAgYXBwLnF1aXQoKVxuICB9XG59KVxuXG5hcHAub24oJ2FjdGl2YXRlJywgZnVuY3Rpb24gKCkge1xuICBpZiAobWFpbldpbmRvdyA9PT0gbnVsbCkge1xuICAgIGNyZWF0ZVdpbmRvdygpXG4gIH1cbn0pXG4iXX0=
'use strict';

var qs = require('qs');
var path = require('path');
var electron = require('electron');
var app = electron.app;
var BrowserWindow = electron.BrowserWindow;

if (!app) {
  throw new Error('You can only run electron.js from an electron process');
}

var url = 'file://' + path.join(__dirname, '..', 'index.html');

var params = {
  folder: process.env.HAIKU_PROJECT_FOLDER,
  plumbing: process.env.HAIKU_PLUMBING_URL
};

if (process.env.MOCK_ENVOY === '1') {
  params.envoy = { mock: true };
}

var query = qs.stringify(params);

url = url + '?' + query;

var browserWindow = null;

app.on('window-all-closed', function () {
  app.quit();
});

function createWindow() {
  browserWindow = new BrowserWindow({
    webPreferences: {
      webSecurity: false
    }
  });
  browserWindow.maximize();
  browserWindow.loadURL(url);

  if (process.env.DEV === '1') {
    browserWindow.webContents.openDevTools();
  }

  browserWindow.on('closed', function () {
    browserWindow = null;
  });
}

app.on('ready', createWindow);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbGVjdHJvbi5qcyJdLCJuYW1lcyI6WyJxcyIsInJlcXVpcmUiLCJwYXRoIiwiZWxlY3Ryb24iLCJhcHAiLCJCcm93c2VyV2luZG93IiwiRXJyb3IiLCJ1cmwiLCJqb2luIiwiX19kaXJuYW1lIiwicGFyYW1zIiwiZm9sZGVyIiwicHJvY2VzcyIsImVudiIsIkhBSUtVX1BST0pFQ1RfRk9MREVSIiwicGx1bWJpbmciLCJIQUlLVV9QTFVNQklOR19VUkwiLCJNT0NLX0VOVk9ZIiwiZW52b3kiLCJtb2NrIiwicXVlcnkiLCJzdHJpbmdpZnkiLCJicm93c2VyV2luZG93Iiwib24iLCJxdWl0IiwiY3JlYXRlV2luZG93Iiwid2ViUHJlZmVyZW5jZXMiLCJ3ZWJTZWN1cml0eSIsIm1heGltaXplIiwibG9hZFVSTCIsIkRFViIsIndlYkNvbnRlbnRzIiwib3BlbkRldlRvb2xzIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUlBLEtBQUtDLFFBQVEsSUFBUixDQUFUO0FBQ0EsSUFBSUMsT0FBT0QsUUFBUSxNQUFSLENBQVg7QUFDQSxJQUFJRSxXQUFXRixRQUFRLFVBQVIsQ0FBZjtBQUNBLElBQUlHLE1BQU1ELFNBQVNDLEdBQW5CO0FBQ0EsSUFBSUMsZ0JBQWdCRixTQUFTRSxhQUE3Qjs7QUFFQSxJQUFJLENBQUNELEdBQUwsRUFBVTtBQUNSLFFBQU0sSUFBSUUsS0FBSixDQUFVLHVEQUFWLENBQU47QUFDRDs7QUFFRCxJQUFJQyxNQUFNLFlBQVlMLEtBQUtNLElBQUwsQ0FBVUMsU0FBVixFQUFxQixJQUFyQixFQUEyQixZQUEzQixDQUF0Qjs7QUFFQSxJQUFJQyxTQUFTO0FBQ1hDLFVBQVFDLFFBQVFDLEdBQVIsQ0FBWUMsb0JBRFQ7QUFFWEMsWUFBVUgsUUFBUUMsR0FBUixDQUFZRztBQUZYLENBQWI7O0FBS0EsSUFBSUosUUFBUUMsR0FBUixDQUFZSSxVQUFaLEtBQTJCLEdBQS9CLEVBQW9DO0FBQ2xDUCxTQUFPUSxLQUFQLEdBQWUsRUFBRUMsTUFBTSxJQUFSLEVBQWY7QUFDRDs7QUFFRCxJQUFNQyxRQUFRcEIsR0FBR3FCLFNBQUgsQ0FBYVgsTUFBYixDQUFkOztBQUVBSCxNQUFTQSxHQUFULFNBQWdCYSxLQUFoQjs7QUFFQSxJQUFJRSxnQkFBZ0IsSUFBcEI7O0FBRUFsQixJQUFJbUIsRUFBSixDQUFPLG1CQUFQLEVBQTRCLFlBQU07QUFDaENuQixNQUFJb0IsSUFBSjtBQUNELENBRkQ7O0FBSUEsU0FBU0MsWUFBVCxHQUF5QjtBQUN2Qkgsa0JBQWdCLElBQUlqQixhQUFKLENBQWtCO0FBQ2hDcUIsb0JBQWdCO0FBQ2RDLG1CQUFhO0FBREM7QUFEZ0IsR0FBbEIsQ0FBaEI7QUFLQUwsZ0JBQWNNLFFBQWQ7QUFDQU4sZ0JBQWNPLE9BQWQsQ0FBc0J0QixHQUF0Qjs7QUFFQSxNQUFJSyxRQUFRQyxHQUFSLENBQVlpQixHQUFaLEtBQW9CLEdBQXhCLEVBQTZCO0FBQzNCUixrQkFBY1MsV0FBZCxDQUEwQkMsWUFBMUI7QUFDRDs7QUFFRFYsZ0JBQWNDLEVBQWQsQ0FBaUIsUUFBakIsRUFBMkIsWUFBTTtBQUFFRCxvQkFBZ0IsSUFBaEI7QUFBc0IsR0FBekQ7QUFDRDs7QUFFRGxCLElBQUltQixFQUFKLENBQU8sT0FBUCxFQUFnQkUsWUFBaEIiLCJmaWxlIjoiZWxlY3Ryb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgcXMgPSByZXF1aXJlKCdxcycpXG52YXIgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKVxudmFyIGVsZWN0cm9uID0gcmVxdWlyZSgnZWxlY3Ryb24nKVxudmFyIGFwcCA9IGVsZWN0cm9uLmFwcFxudmFyIEJyb3dzZXJXaW5kb3cgPSBlbGVjdHJvbi5Ccm93c2VyV2luZG93XG5cbmlmICghYXBwKSB7XG4gIHRocm93IG5ldyBFcnJvcignWW91IGNhbiBvbmx5IHJ1biBlbGVjdHJvbi5qcyBmcm9tIGFuIGVsZWN0cm9uIHByb2Nlc3MnKVxufVxuXG52YXIgdXJsID0gJ2ZpbGU6Ly8nICsgcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uJywgJ2luZGV4Lmh0bWwnKVxuXG52YXIgcGFyYW1zID0ge1xuICBmb2xkZXI6IHByb2Nlc3MuZW52LkhBSUtVX1BST0pFQ1RfRk9MREVSLFxuICBwbHVtYmluZzogcHJvY2Vzcy5lbnYuSEFJS1VfUExVTUJJTkdfVVJMXG59XG5cbmlmIChwcm9jZXNzLmVudi5NT0NLX0VOVk9ZID09PSAnMScpIHtcbiAgcGFyYW1zLmVudm95ID0geyBtb2NrOiB0cnVlIH1cbn1cblxuY29uc3QgcXVlcnkgPSBxcy5zdHJpbmdpZnkocGFyYW1zKVxuXG51cmwgPSBgJHt1cmx9PyR7cXVlcnl9YFxuXG5sZXQgYnJvd3NlcldpbmRvdyA9IG51bGxcblxuYXBwLm9uKCd3aW5kb3ctYWxsLWNsb3NlZCcsICgpID0+IHtcbiAgYXBwLnF1aXQoKVxufSlcblxuZnVuY3Rpb24gY3JlYXRlV2luZG93ICgpIHtcbiAgYnJvd3NlcldpbmRvdyA9IG5ldyBCcm93c2VyV2luZG93KHtcbiAgICB3ZWJQcmVmZXJlbmNlczoge1xuICAgICAgd2ViU2VjdXJpdHk6IGZhbHNlXG4gICAgfVxuICB9KVxuICBicm93c2VyV2luZG93Lm1heGltaXplKClcbiAgYnJvd3NlcldpbmRvdy5sb2FkVVJMKHVybClcblxuICBpZiAocHJvY2Vzcy5lbnYuREVWID09PSAnMScpIHtcbiAgICBicm93c2VyV2luZG93LndlYkNvbnRlbnRzLm9wZW5EZXZUb29scygpXG4gIH1cblxuICBicm93c2VyV2luZG93Lm9uKCdjbG9zZWQnLCAoKSA9PiB7IGJyb3dzZXJXaW5kb3cgPSBudWxsIH0pXG59XG5cbmFwcC5vbigncmVhZHknLCBjcmVhdGVXaW5kb3cpXG4iXX0=
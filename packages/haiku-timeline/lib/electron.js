'use strict';

var qs = require('qs');
var path = require('path');
var electron = require('electron');
var app = electron.app;
var BrowserWindow = electron.BrowserWindow;

/**
 * This file is bypassed when loaded in the full app.
 * This is only used as a harness for developin on glass standalone.
 */

if (!app) {
  throw new Error('You can only run electron.js from an electron process');
}

var url = 'file://' + path.join(__dirname, '..', 'index.html');

var params = {
  email: 'matthew+SENTRY-TESTING-USER@haiku.ai',
  folder: process.env.HAIKU_PROJECT_FOLDER,
  plumbing: process.env.HAIKU_PLUMBING_URL
};

if (process.env.MOCK_ENVOY === '1') {
  params.envoy = { mock: true };
}

var query = qs.stringify(params);

url = url + '?' + query;

var browserWindow = null;

app.on('window-all-closed', function () {
  app.quit();
});

function createWindow() {
  browserWindow = new BrowserWindow({
    webPreferences: {
      webSecurity: false
    }
  });
  browserWindow.maximize();
  browserWindow.loadURL(url);

  if (process.env.DEV === '1') {
    browserWindow.webContents.openDevTools();
  }

  browserWindow.on('closed', function () {
    browserWindow = null;
  });
}

app.on('ready', createWindow);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbGVjdHJvbi5qcyJdLCJuYW1lcyI6WyJxcyIsInJlcXVpcmUiLCJwYXRoIiwiZWxlY3Ryb24iLCJhcHAiLCJCcm93c2VyV2luZG93IiwiRXJyb3IiLCJ1cmwiLCJqb2luIiwiX19kaXJuYW1lIiwicGFyYW1zIiwiZW1haWwiLCJmb2xkZXIiLCJwcm9jZXNzIiwiZW52IiwiSEFJS1VfUFJPSkVDVF9GT0xERVIiLCJwbHVtYmluZyIsIkhBSUtVX1BMVU1CSU5HX1VSTCIsIk1PQ0tfRU5WT1kiLCJlbnZveSIsIm1vY2siLCJxdWVyeSIsInN0cmluZ2lmeSIsImJyb3dzZXJXaW5kb3ciLCJvbiIsInF1aXQiLCJjcmVhdGVXaW5kb3ciLCJ3ZWJQcmVmZXJlbmNlcyIsIndlYlNlY3VyaXR5IiwibWF4aW1pemUiLCJsb2FkVVJMIiwiREVWIiwid2ViQ29udGVudHMiLCJvcGVuRGV2VG9vbHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSUEsS0FBS0MsUUFBUSxJQUFSLENBQVQ7QUFDQSxJQUFJQyxPQUFPRCxRQUFRLE1BQVIsQ0FBWDtBQUNBLElBQUlFLFdBQVdGLFFBQVEsVUFBUixDQUFmO0FBQ0EsSUFBSUcsTUFBTUQsU0FBU0MsR0FBbkI7QUFDQSxJQUFJQyxnQkFBZ0JGLFNBQVNFLGFBQTdCOztBQUVBOzs7OztBQUtBLElBQUksQ0FBQ0QsR0FBTCxFQUFVO0FBQ1IsUUFBTSxJQUFJRSxLQUFKLENBQVUsdURBQVYsQ0FBTjtBQUNEOztBQUVELElBQUlDLE1BQU0sWUFBWUwsS0FBS00sSUFBTCxDQUFVQyxTQUFWLEVBQXFCLElBQXJCLEVBQTJCLFlBQTNCLENBQXRCOztBQUVBLElBQUlDLFNBQVM7QUFDWEMsU0FBTyxzQ0FESTtBQUVYQyxVQUFRQyxRQUFRQyxHQUFSLENBQVlDLG9CQUZUO0FBR1hDLFlBQVVILFFBQVFDLEdBQVIsQ0FBWUc7QUFIWCxDQUFiOztBQU1BLElBQUlKLFFBQVFDLEdBQVIsQ0FBWUksVUFBWixLQUEyQixHQUEvQixFQUFvQztBQUNsQ1IsU0FBT1MsS0FBUCxHQUFlLEVBQUVDLE1BQU0sSUFBUixFQUFmO0FBQ0Q7O0FBRUQsSUFBTUMsUUFBUXJCLEdBQUdzQixTQUFILENBQWFaLE1BQWIsQ0FBZDs7QUFFQUgsTUFBU0EsR0FBVCxTQUFnQmMsS0FBaEI7O0FBRUEsSUFBSUUsZ0JBQWdCLElBQXBCOztBQUVBbkIsSUFBSW9CLEVBQUosQ0FBTyxtQkFBUCxFQUE0QixZQUFNO0FBQ2hDcEIsTUFBSXFCLElBQUo7QUFDRCxDQUZEOztBQUlBLFNBQVNDLFlBQVQsR0FBeUI7QUFDdkJILGtCQUFnQixJQUFJbEIsYUFBSixDQUFrQjtBQUNoQ3NCLG9CQUFnQjtBQUNkQyxtQkFBYTtBQURDO0FBRGdCLEdBQWxCLENBQWhCO0FBS0FMLGdCQUFjTSxRQUFkO0FBQ0FOLGdCQUFjTyxPQUFkLENBQXNCdkIsR0FBdEI7O0FBRUEsTUFBSU0sUUFBUUMsR0FBUixDQUFZaUIsR0FBWixLQUFvQixHQUF4QixFQUE2QjtBQUMzQlIsa0JBQWNTLFdBQWQsQ0FBMEJDLFlBQTFCO0FBQ0Q7O0FBRURWLGdCQUFjQyxFQUFkLENBQWlCLFFBQWpCLEVBQTJCLFlBQU07QUFBRUQsb0JBQWdCLElBQWhCO0FBQXNCLEdBQXpEO0FBQ0Q7O0FBRURuQixJQUFJb0IsRUFBSixDQUFPLE9BQVAsRUFBZ0JFLFlBQWhCIiwiZmlsZSI6ImVsZWN0cm9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHFzID0gcmVxdWlyZSgncXMnKVxudmFyIHBhdGggPSByZXF1aXJlKCdwYXRoJylcbnZhciBlbGVjdHJvbiA9IHJlcXVpcmUoJ2VsZWN0cm9uJylcbnZhciBhcHAgPSBlbGVjdHJvbi5hcHBcbnZhciBCcm93c2VyV2luZG93ID0gZWxlY3Ryb24uQnJvd3NlcldpbmRvd1xuXG4vKipcbiAqIFRoaXMgZmlsZSBpcyBieXBhc3NlZCB3aGVuIGxvYWRlZCBpbiB0aGUgZnVsbCBhcHAuXG4gKiBUaGlzIGlzIG9ubHkgdXNlZCBhcyBhIGhhcm5lc3MgZm9yIGRldmVsb3BpbiBvbiBnbGFzcyBzdGFuZGFsb25lLlxuICovXG5cbmlmICghYXBwKSB7XG4gIHRocm93IG5ldyBFcnJvcignWW91IGNhbiBvbmx5IHJ1biBlbGVjdHJvbi5qcyBmcm9tIGFuIGVsZWN0cm9uIHByb2Nlc3MnKVxufVxuXG52YXIgdXJsID0gJ2ZpbGU6Ly8nICsgcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uJywgJ2luZGV4Lmh0bWwnKVxuXG52YXIgcGFyYW1zID0ge1xuICBlbWFpbDogJ21hdHRoZXcrU0VOVFJZLVRFU1RJTkctVVNFUkBoYWlrdS5haScsXG4gIGZvbGRlcjogcHJvY2Vzcy5lbnYuSEFJS1VfUFJPSkVDVF9GT0xERVIsXG4gIHBsdW1iaW5nOiBwcm9jZXNzLmVudi5IQUlLVV9QTFVNQklOR19VUkxcbn1cblxuaWYgKHByb2Nlc3MuZW52Lk1PQ0tfRU5WT1kgPT09ICcxJykge1xuICBwYXJhbXMuZW52b3kgPSB7IG1vY2s6IHRydWUgfVxufVxuXG5jb25zdCBxdWVyeSA9IHFzLnN0cmluZ2lmeShwYXJhbXMpXG5cbnVybCA9IGAke3VybH0/JHtxdWVyeX1gXG5cbmxldCBicm93c2VyV2luZG93ID0gbnVsbFxuXG5hcHAub24oJ3dpbmRvdy1hbGwtY2xvc2VkJywgKCkgPT4ge1xuICBhcHAucXVpdCgpXG59KVxuXG5mdW5jdGlvbiBjcmVhdGVXaW5kb3cgKCkge1xuICBicm93c2VyV2luZG93ID0gbmV3IEJyb3dzZXJXaW5kb3coe1xuICAgIHdlYlByZWZlcmVuY2VzOiB7XG4gICAgICB3ZWJTZWN1cml0eTogZmFsc2VcbiAgICB9XG4gIH0pXG4gIGJyb3dzZXJXaW5kb3cubWF4aW1pemUoKVxuICBicm93c2VyV2luZG93LmxvYWRVUkwodXJsKVxuXG4gIGlmIChwcm9jZXNzLmVudi5ERVYgPT09ICcxJykge1xuICAgIGJyb3dzZXJXaW5kb3cud2ViQ29udGVudHMub3BlbkRldlRvb2xzKClcbiAgfVxuXG4gIGJyb3dzZXJXaW5kb3cub24oJ2Nsb3NlZCcsICgpID0+IHsgYnJvd3NlcldpbmRvdyA9IG51bGwgfSlcbn1cblxuYXBwLm9uKCdyZWFkeScsIGNyZWF0ZVdpbmRvdylcbiJdfQ==